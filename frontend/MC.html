<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EYC | Mission Control</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Orbitron:wght@400;700;900&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --gold: #b38728; /* Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ Ù…Ø·ÙØ£ Ù„Ù„Ø£Ù†Ø§Ù‚Ø© */
            --gold-bright: #D4AF37;
            --bg-deep: #030306;
            --glass: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(212, 175, 55, 0.15);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg-deep); color: white; min-height: 100vh; overflow-x: hidden; }

        /* --- Floating Fairytale Aide --- */
        .fairytale-float {
            position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px;
            background: var(--gold-gradient); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 20px var(--gold-glow); z-index: 9999; cursor: pointer;
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        /* --- Header & Stats --- */
        .stats-row { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-top: 15px; }
        .stat-item { background: rgba(255,255,255,0.05); padding: 5px 12px; border-radius: 20px; display: flex; align-items: center; gap: 6px; font-size: 0.8rem; border: 1px solid var(--glass-border); }
        .stat-img { width: 18px; height: 18px; object-fit: contain; }

        /* --- Grid & Cards --- */
        .grid-container { 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
            gap: 15px; padding: 20px; max-width: 1200px; margin: 0 auto;
        }
        .activity-card {
            background: rgba(255,255,255,0.02); border: 1px solid var(--glass-border);
            border-radius: 15px; padding: 25px 10px; text-align: center; position: relative;
        }
        .tk-badge {
            position: absolute; top: 10px; right: 10px; background: rgba(212, 175, 55, 0.2);
            color: var(--gold-bright); font-size: 0.6rem; padding: 2px 8px; border-radius: 10px; font-family: 'Orbitron';
        }

        /* --- Task Nodes & Locks --- */
        .tasks-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; }
        .task-node { 
            aspect-ratio: 1; background: rgba(255,255,255,0.05); border-radius: 8px;
            display: flex; align-items: center; justify-content: center; position: relative;
            font-family: 'Orbitron'; font-size: 0.7rem; cursor: pointer;
        }
        .lock-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.7); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--gold); font-size: 0.8rem; }
        .date-toast {
            position: absolute; top: -35px; left: 50%; transform: translateX(-50%);
            background: #000; color: var(--gold); padding: 4px 8px; border-radius: 4px;
            font-size: 0.6rem; white-space: nowrap; display: none; border: 1px solid var(--gold); z-index: 10;
        }

        /* --- Mailbox UI Refined --- */
        .mail-card {
            background: #0a0a0f; border: 1px solid var(--glass-border); border-radius: 12px;
            padding: 15px; margin-bottom: 12px; cursor: pointer; transition: 0.3s;
        }
        .mail-card:hover { border-color: var(--gold-bright); background: rgba(212, 175, 55, 0.05); }
        .mail-header { display: flex; justify-content: space-between; font-size: 0.65rem; color: #777; margin-bottom: 8px; }

        @media (max-width: 600px) {
            .grid-container { grid-template-columns: repeat(2, 1fr); }
            .hero-banner { padding-top: 80px; }
        }
    </style>
</head>
<body>

    <div class="fairytale-float" onclick="openChat()"><i class="fas fa-magic"></i></div>

    <header class="hero-banner" id="heroBanner"></header>

    <nav class="nav-container">
        <div class="tab-switcher" style="margin: 0 auto;">
            <button class="tab-btn active" onclick="switchType('season', this)">SEASON</button>
            <button class="tab-btn" onclick="switchType('royal', this)">ROYAL X</button>
        </div>
    </nav>

    <main><div class="grid-container" id="cardsGrid"></div></main>

    <div class="modal" id="taskModal"><div class="modal-content">...</div></div>

    <script>
        const IMG_ASSETS = {
            token: "https://raw.githubusercontent.com/eycfde-prog/EYCSSP/main/frontend/eyclgos/Token.png",
            star: "https://raw.githubusercontent.com/eycfde-prog/EYCSSP/main/frontend/eyclgos/Star.png",
            gt: "https://raw.githubusercontent.com/eycfde-prog/EYCSSP/main/frontend/eyclgos/GT.png"
        };

        const activities = {
            season: [
                { name: "Alike", icon: "fa-clone", code: "AS", tk: 50 },
                { name: "Label", icon: "fa-tag", code: "LB", tk: 50 },
                { name: "Golden Ear", icon: "fa-ear-listen", code: "GE", tk: 50 },
                { name: "Grammar", icon: "fa-spell-check", code: "GR", tk: 50 },
                { name: "Vivid", icon: "fa-wand-magic-sparkles", code: "VV", tk: 50 },
                { name: "Seeds", icon: "fa-seedling", code: "SD", tk: 50 }
            ],
            royal: [
                { name: "Alike X", icon: "fa-star", code: "ASX", tk: 50 },
                { name: "Label X", icon: "fa-tags", code: "LBX", tk: 50 },
                { name: "Golden Ear X", icon: "fa-ear-deaf", code: "GEX", tk: 50 },
                { name: "Grammar X", icon: "fa-pen-fancy", code: "GRX", tk: 50 },
                { name: "Vivid X", icon: "fa-wand-magic", code: "VVX", tk: 50 },
                { name: "Seeds X", icon: "fa-tree", code: "SDX", tk: 50 },
                { name: "Figurative X", icon: "fa-mask", code: "FGX", tk: 50 },
                { name: "Dictation X", icon: "fa-microphone-lines", code: "DTX", tk: 100 },
                { name: "Sing Sang Sung X", icon: "fa-music", code: "SSSX", tk: 100 },
                { name: "Elmagazine X", icon: "fa-book-open", code: "EMX", tk: 100 }
            ]
        };

        function getTaskUnlockDate(type, taskIndex) {
            if (taskIndex === 1) return null; // Ø£ÙˆÙ„ Ù…Ù‡Ù…Ø© Ù…ÙØªÙˆØ­Ø© Ø¯Ø§Ø¦Ù…Ø§Ù‹
            
            let date = new Date(2026, 1, 28); // Ø§Ù„Ø³Ø¨Øª 28 ÙØ¨Ø±Ø§ÙŠØ±
            if (type === 'season') {
                // S: +4, +5, +6...
                let extraDays = 0;
                for(let i=2; i<taskIndex; i++) { extraDays += (i + 2); }
                date.setDate(date.getDate() + extraDays);
            } else {
                // R: Ø«Ø§Ø¨Øª +3 Ø£ÙŠØ§Ù…
                date.setDate(date.getDate() + (taskIndex - 2) * 3);
            }
            return date;
        }

        function generateCards() {
            const grid = document.getElementById('cardsGrid'); grid.innerHTML = '';
            const type = document.querySelector('.tab-btn.active').innerText.toLowerCase().includes('royal') ? 'royal' : 'season';
            
            activities[type].forEach(act => {
                const card = document.createElement('div');
                card.className = 'activity-card';
                card.innerHTML = `
                    <div class="tk-badge">${act.tk} TK</div>
                    <i class="fa-solid ${act.icon} card-icon" style="font-size: 2rem; color:var(--gold); margin-bottom:10px;"></i>
                    <h3 style="font-size:0.75rem; letter-spacing:1px;">${act.name}</h3>
                `;
                card.onclick = () => openTasks(act, type);
                grid.appendChild(card);
            });
        }

        function openTasks(act, type) {
            document.getElementById('mTitle').innerText = act.name;
            const tGrid = document.getElementById('tGrid'); tGrid.innerHTML = '';
            
            for (let i = 1; i <= 10; i++) {
                const node = document.createElement('div');
                node.className = 'task-node';
                node.innerHTML = `<span>${i}</span>`;
                
                const unlockDate = getTaskUnlockDate(type, i);
                const isLocked = unlockDate && unlockDate > new Date();

                if (isLocked) {
                    node.innerHTML += `<div class="lock-overlay"><i class="fas fa-lock"></i></div>`;
                    const toast = document.createElement('div');
                    toast.className = 'date-toast';
                    toast.innerText = `Available: ${unlockDate.toDateString()}`;
                    node.appendChild(toast);
                    
                    node.onclick = (e) => {
                        e.stopPropagation();
                        toast.style.display = 'block';
                        setTimeout(() => toast.style.display = 'none', 2000);
                    };
                } else {
                    node.onclick = () => {
                        if (!isLoggedIn) return openLogin();
                        // Ø§Ù†ØªÙ‚Ù„ Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ù‡Ù…Ø©
                    };
                }
                tGrid.appendChild(node);
            }
            document.getElementById('taskModal').style.display = 'flex';
        }

        // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± ÙÙŠ Ø§Ù„Ù‡ÙŠØ¯Ø±
        function renderHeader() {
            // ... (Ù†ÙØ³ Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø¨Ø§Ù„ØµÙˆØ± Ù…Ù† IMG_ASSETS)
            // Ù…Ø«Ø§Ù„: <img src="${IMG_ASSETS.token}" class="stat-img"> <span>${currentUser.tokens}</span>
        }

        function openChat() {
            alert("EYC Guide: FairyTale Chat System coming soon! ğŸ§šâœ¨");
        }

        window.onload = () => {
            generateCards();
            // ... Ø¨Ù‚ÙŠØ© Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„
        };
    </script>
</body>
</html>
